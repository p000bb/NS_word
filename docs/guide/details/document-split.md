# 拆分文档

将包含多个章节的大型 Word 文档拆分成多个独立的文档。

## 功能概述

拆分文档功能可以自动识别文档中的一级标题（标题 1 样式），将大型文档按章节拆分成多个小文档。每个拆分后的文档都可以应用模板文件的格式，支持智能分组管理和灵活的拖拽操作。

::: tip 拆分设置
拆分文档的相关配置可以在**拆分设置**中进行调整，包括分组初始拆分章节数和跳过标题列表等选项。
:::

## 使用步骤

### 1. 选择模板文件

点击"选择文件"按钮，选择用于拆分的模板 Word 文档（可选）。

模板文件将应用于每个拆分后的文档。
![选择模板文件](https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-37-45.png)

### 2. 选择保存路径

点击"选择文件夹"按钮，选择拆分后文档的保存位置。

::: tip 快速访问
选择保存路径后，可以直接点击显示的文件夹地址，系统会自动打开本地文件夹，方便您查看保存位置。
:::

![选择保存路径](https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-38-10.png)

### 3. 配置拆分设置（可选）

在拆分设置中可以配置以下选项：

#### 分组初始拆分章节数

设置每个分组初始包含的章节数量，默认值为 **1**，可设置范围为 **1-15**。

#### 跳过标题列表

配置需要跳过的标题列表，系统在解析文档时会自动排除这些标题。默认包含以下 9 个标题：

**中文标题**：
- 目录
- 表目录
- 图目录

**英文标题**：
- Content
- List of Table
- List of Figure
- Contents
- List of Tables
- List of Figures

::: tip 标题匹配规则
- 支持添加、修改、删除跳过标题
- 标题匹配时**忽略大小写**，例如"Content"和"content"会被视为同一个标题
:::

![配置拆分设置](https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-39-06.png)

### 4. 上传文档

点击上传区域或拖拽文件到上传区域。

系统会自动解析文档中的所有一级标题，并根据配置的跳过标题列表自动排除相应标题。

![上传文档](https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-39-27.png)

### 5. 分组和拆分

系统会根据"分组初始拆分章节数"的设置自动创建分组。您可以使用以下功能灵活调整分组：

#### 拖拽合并
将分组卡片拖拽到另一个分组上方可合并两个分组，合并后自动按章节序号排序。

::: warning 重要
合并分组时，两个分组中的章节必须连续（按序号连续），否则无法合并。
:::

![拖拽合并](https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-40-31.png)

#### 编辑名称
点击分组名称或编辑按钮可自定义分组名称，按回车保存，按 ESC 取消。

![编辑名称](https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-40-58.png)

#### 删除分组
点击删除按钮可移除不需要的分组。

![删除分组](https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-41-34.png)

#### 移除章节
在分组中点击章节右侧的删除按钮，可将该章节从当前分组移除，移除后会自动创建新分组。

::: warning 重要
从分组中移除章节时，如果移除后剩余章节不连续，系统会阻止该操作。
:::

![移除章节](https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-42-06.png)

#### 重置分组
点击"重置分组"按钮可一键恢复为初始状态（根据分组初始拆分章节数设置）。

![重置分组](https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-42-28.png)

### 6. 开始拆分

确认分组配置无误后，点击"开始拆分"按钮执行拆分操作。

## 功能特点

- ✅ **智能分组管理**：根据配置自动创建分组，支持拖拽合并，自动检查章节连续性
- ✅ **灵活配置**：可配置分组初始拆分章节数（1-15）和跳过标题列表
- ✅ **标题过滤**：支持自定义跳过标题列表，忽略大小写匹配，自动排除目录类标题
- ✅ **分组调整**：支持自定义分组名称、移除章节、删除分组等灵活操作
- ✅ **可视化操作**：拖拽时显示实时预览，目标分组高亮显示，操作反馈明确
- ✅ **实时反馈**：显示每个分组的处理状态和系统处理进度，失败时显示具体错误信息

## 拆分设置说明

### 分组初始拆分章节数

- **默认值**：1
- **取值范围**：1-15
- **作用**：设置每个分组初始包含的章节数量。例如设置为 3，则系统会自动将每 3 个连续章节合并到一个分组中

### 跳过标题列表

- **默认标题**：系统默认包含 9 个跳过标题（3 个中文 + 6 个英文）
- **匹配规则**：标题匹配时**忽略大小写**
- **管理功能**：支持添加、修改、删除跳过标题
- **作用**：在解析文档时，系统会自动排除这些标题，不会将它们作为拆分章节

::: tip 使用建议
如果您的文档中包含其他不需要拆分的标题（如"前言"、"附录"等），可以将其添加到跳过标题列表中。
:::

## 注意事项

::: warning 重要提示
如果打开拆分后的文档时出现了 Office 警告，点击"是"即可，Office 会自动修复，不影响后续合并功能。

**office的自动修复主要是为了修复以下问题**
- 命名空间规范化
- 资源文件命名规范化
:::

- 系统会提取文档中的所有一级标题（标题 1 样式），但会根据跳过标题列表自动排除相应标题
- 文档必须包含一级标题（标题 1 样式），系统才能正确识别章节
- 如果文档中没有找到一级标题，系统会提示错误
- 拆分后的文档会使用模板文件的格式（如果已选择模板）
- 分组初始拆分章节数会影响初始分组的创建，但后续可以手动调整分组

## 相关链接

- [模板生成](./template-generation.md) - 生成拆分时使用的模板
- [合并文档](./document-merge.md) - 将拆分后的文档重新合并
- [导出 PDF](./export-pdf.md) - 将 Word 文档导出为 PDF 格式
