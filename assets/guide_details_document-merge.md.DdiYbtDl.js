import{_ as t,c as e,o as i,ao as l}from"./chunks/framework.CIBfAoRC.js";const g=JSON.parse('{"title":"合并文档","description":"","frontmatter":{},"headers":[],"relativePath":"guide/details/document-merge.md","filePath":"guide/details/document-merge.md","lastUpdated":1770271214000}'),s={name:"guide/details/document-merge.md"};function o(r,a,n,h,d,c){return i(),e("div",null,[...a[0]||(a[0]=[l('<h1 id="合并文档" tabindex="-1">合并文档 <a class="header-anchor" href="#合并文档" aria-label="Permalink to “合并文档”">​</a></h1><p>将多个 Word 文档按顺序合并成一个完整的文档。</p><h2 id="功能概述" tabindex="-1">功能概述 <a class="header-anchor" href="#功能概述" aria-label="Permalink to “功能概述”">​</a></h2><p>合并文档功能可以将多个 Word 文档根据模板文档的样式按照指定顺序合并成一个完整的文档。合并完成后，系统会自动生成目录、表目录、图目录，支持中英文两种语言模式。</p><div class="info custom-block"><p class="custom-block-title">技术实现</p><p>合并子文档功能通过调用 <a href="https://github.com/jamessantiago/DocxMerge" target="_blank" rel="noreferrer">DocxMerge</a> 程序执行。DocxMerge 是一个简单的命令行工具，用于按顺序合并多个 Word 文档。</p></div><h2 id="使用步骤" tabindex="-1">使用步骤 <a class="header-anchor" href="#使用步骤" aria-label="Permalink to “使用步骤”">​</a></h2><h3 id="_1-选择模板文件" tabindex="-1">1. 选择模板文件 <a class="header-anchor" href="#_1-选择模板文件" aria-label="Permalink to “1. 选择模板文件”">​</a></h3><p>点击&quot;选择文件&quot;按钮，选择用于合并的模板 Word 文档（可选）。</p><p>模板文件将作为合并后文档的基础格式。</p><p><img src="https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-55-22.png" alt="选择模板文件"></p><h3 id="_2-选择保存路径" tabindex="-1">2. 选择保存路径 <a class="header-anchor" href="#_2-选择保存路径" aria-label="Permalink to “2. 选择保存路径”">​</a></h3><p>点击&quot;选择文件夹&quot;按钮，选择合并后文档的保存位置。</p><div class="tip custom-block"><p class="custom-block-title">快速访问</p><p>选择保存路径后，可以直接点击显示的文件夹地址，系统会自动打开本地文件夹，方便您查看保存位置。</p></div><p><img src="https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-55-37.png" alt="选择保存路径"></p><h3 id="_3-选择目录语言" tabindex="-1">3. 选择目录语言 <a class="header-anchor" href="#_3-选择目录语言" aria-label="Permalink to “3. 选择目录语言”">​</a></h3><p>选择目录、表目录、图目录的显示语言：</p><ul><li><strong>中文</strong>：目录、表目录、图目录</li><li><strong>English</strong>：Contents、List of Tables、List of Figures</li></ul><p><img src="https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-55-55.png" alt="选择目录语言"></p><h3 id="_4-上传文档" tabindex="-1">4. 上传文档 <a class="header-anchor" href="#_4-上传文档" aria-label="Permalink to “4. 上传文档”">​</a></h3><p><strong>方式一</strong>：点击上传区域，选择多个 <code>.docx</code> 文件</p><p><strong>方式二</strong>：直接拖拽文件到上传区域</p><p>支持多次上传，同名文件会自动覆盖。</p><p><img src="https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-56-21.png" alt="上传文档"></p><h3 id="_5-调整文档顺序-可选" tabindex="-1">5. 调整文档顺序（可选） <a class="header-anchor" href="#_5-调整文档顺序-可选" aria-label="Permalink to “5. 调整文档顺序（可选）”">​</a></h3><p>在文档列表中，拖拽文件卡片可以调整合并顺序：</p><ul><li>蓝色指示线显示插入位置</li><li>点击&quot;恢复默认顺序&quot;可恢复为上传时的顺序</li><li>点击&quot;清空所有文档&quot;可移除所有文档</li></ul><p><img src="https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-56-54.png" alt="调整文档顺序"></p><h3 id="_6-开始合并" tabindex="-1">6. 开始合并 <a class="header-anchor" href="#_6-开始合并" aria-label="Permalink to “6. 开始合并”">​</a></h3><p>确认文档列表和配置无误后，点击&quot;开始合并&quot;按钮。</p><p>系统会显示每个文档的处理状态，合并完成后会显示成功和失败的数量。</p><p><img src="https://raw.githubusercontent.com/p000bb/Image/master/NS_word/2026-01-16-14-58-12.png" alt="开始合并"></p><h3 id="_7-更新域代码" tabindex="-1">7. 更新域代码 <a class="header-anchor" href="#_7-更新域代码" aria-label="Permalink to “7. 更新域代码”">​</a></h3><div class="warning custom-block"><p class="custom-block-title">重要提示</p><p>合并完成后，需要在 Microsoft Word 中打开文档，按 <code>F9</code> 键更新域代码，目录才会显示完整内容。</p></div><h3 id="_8-优化文档体积" tabindex="-1">8. 优化文档体积 <a class="header-anchor" href="#_8-优化文档体积" aria-label="Permalink to “8. 优化文档体积”">​</a></h3><div class="info custom-block"><p class="custom-block-title">文档体积说明</p><p>合并后的文档体积会比较大，因为使用的是链接的方式合并所有文档，所以合并后的体积是所有文档体积之和。建议使用 Microsoft Word重新保存一下文档，Office 会自动修复处理并优化文档体积。</p></div><h2 id="功能特点" tabindex="-1">功能特点 <a class="header-anchor" href="#功能特点" aria-label="Permalink to “功能特点”">​</a></h2><ul><li>✅ <strong>拖拽排序</strong>：支持通过拖拽调整文档合并顺序，操作直观便捷</li><li>✅ <strong>实时状态</strong>：显示每个文档的处理状态（待处理/处理中/已完成/失败）</li><li>✅ <strong>进度提示</strong>：显示系统处理进度和阶段信息，实时反馈处理情况</li><li>✅ <strong>错误提示</strong>：如果某个文档处理失败，会显示具体错误信息，便于排查问题</li><li>✅ <strong>自动生成目录</strong>：合并完成后自动生成目录、表目录、图目录，支持中英文两种模式</li><li>✅ <strong>多语言支持</strong>：支持中文和英文两种目录语言模式，满足不同文档需求</li></ul><h2 id="目录生成逻辑" tabindex="-1">目录生成逻辑 <a class="header-anchor" href="#目录生成逻辑" aria-label="Permalink to “目录生成逻辑”">​</a></h2><h3 id="_1-目录生成" tabindex="-1">1. 目录生成 <a class="header-anchor" href="#_1-目录生成" aria-label="Permalink to “1. 目录生成”">​</a></h3><p>系统会根据选择的语言自动生成以下目录：</p><p><strong>中文模式</strong>：</p><ul><li>📑 目录</li><li>📊 表目录</li><li>🖼️ 图目录</li></ul><p><strong>英文模式</strong>：</p><ul><li>📑 Contents</li><li>📊 List of Tables</li><li>🖼️ List of Figures</li></ul><h3 id="_2-目录样式设置" tabindex="-1">2. 目录样式设置 <a class="header-anchor" href="#_2-目录样式设置" aria-label="Permalink to “2. 目录样式设置”">​</a></h3><ul><li>所有目录标题使用模板文档的<strong>标题 1 样式</strong></li><li>目录标题设置为<strong>居中对齐</strong></li><li>目录标题不参与自动编号</li></ul><h3 id="_3-题注提取规则" tabindex="-1">3. 题注提取规则 <a class="header-anchor" href="#_3-题注提取规则" aria-label="Permalink to “3. 题注提取规则”">​</a></h3><p>系统会根据选择的语言提取文档中的题注：</p><p><strong>中文模式</strong>：</p><ul><li><strong>表目录</strong>：提取所有以&quot;表&quot;开头的题注（如&quot;表 1-1&quot;、&quot;表 2-3&quot;等）</li><li><strong>图目录</strong>：提取所有以&quot;图&quot;开头的题注（如&quot;图 1-1&quot;、&quot;图 2-3&quot;等）</li></ul><p><strong>英文模式</strong>：</p><ul><li><strong>表目录</strong>：提取所有以&quot;Table&quot;开头的题注（如&quot;Table 1-1&quot;、&quot;Table 2-3&quot;等）</li><li><strong>图目录</strong>：提取所有以&quot;Figure&quot;开头的题注（如&quot;Figure 1-1&quot;、&quot;Figure 2-3&quot;等）</li></ul><h3 id="_4-域代码说明" tabindex="-1">4. 域代码说明 <a class="header-anchor" href="#_4-域代码说明" aria-label="Permalink to “4. 域代码说明”">​</a></h3><p>系统使用 Word 域代码自动生成目录，各目录使用的域代码如下：</p><p><strong>目录</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>TOC \\o &quot;1-6&quot; \\h \\z \\u</span></span></code></pre></div><ul><li><code>\\o &quot;1-6&quot;</code>：提取标题 1 到标题 6 的内容</li><li><code>\\h</code>：将目录项设置为超链接</li><li><code>\\z</code>：在 Web 视图中隐藏制表符和前导符</li><li><code>\\u</code>：使用应用的样式级别而不是 TC 条目</li></ul><p><strong>表目录</strong>（中文）：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>TOC \\h \\z \\c &quot;表&quot;</span></span></code></pre></div><p><strong>表目录</strong>（英文）：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>TOC \\h \\z \\c &quot;Table&quot;</span></span></code></pre></div><p><strong>图目录</strong>（中文）：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>TOC \\h \\z \\c &quot;图&quot;</span></span></code></pre></div><p><strong>图目录</strong>（英文）：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>TOC \\h \\z \\c &quot;Figure&quot;</span></span></code></pre></div><h3 id="_5-目录位置和格式" tabindex="-1">5. 目录位置和格式 <a class="header-anchor" href="#_5-目录位置和格式" aria-label="Permalink to “5. 目录位置和格式”">​</a></h3><ul><li>三个目录按顺序插入在合并文档的最前面</li><li>每个目录前都有分页符，确保目录独立成页</li><li>目录之间有空行分隔</li><li>目录生成后，需要在 Microsoft Word 中按 <code>F9</code> 更新域代码才能显示完整内容</li></ul><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to “注意事项”">​</a></h2><ul><li>合并顺序按照文档列表中的顺序进行</li><li>如果某个文档处理失败，其他文档仍会继续处理</li><li>合并后的文件名格式：<code>第一个文档名_合并.docx</code></li><li>确保文档中的题注使用正确的标签格式（中文使用&quot;表&quot;和&quot;图&quot;，英文使用&quot;Table&quot;和&quot;Figure&quot;），否则无法正确提取到表目录和图目录中</li></ul><h2 id="相关链接" tabindex="-1">相关链接 <a class="header-anchor" href="#相关链接" aria-label="Permalink to “相关链接”">​</a></h2><ul><li><a href="./template-generation.html">模板生成</a> - 生成合并时使用的模板</li><li><a href="./document-split.html">拆分文档</a> - 将文档拆分成多个小文档</li><li><a href="https://github.com/jamessantiago/DocxMerge" target="_blank" rel="noreferrer">DocxMerge</a> - 合并文档功能使用的底层工具</li></ul>',71)])])}const u=t(s,[["render",o]]);export{g as __pageData,u as default};
